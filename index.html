<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>COX REGRESSION HAZARDS MODEL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="cox_regression_articles_summary_files/libs/clipboard/clipboard.min.js"></script>
<script src="cox_regression_articles_summary_files/libs/quarto-html/quarto.js"></script>
<script src="cox_regression_articles_summary_files/libs/quarto-html/popper.min.js"></script>
<script src="cox_regression_articles_summary_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="cox_regression_articles_summary_files/libs/quarto-html/anchor.min.js"></script>
<link href="cox_regression_articles_summary_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="cox_regression_articles_summary_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="cox_regression_articles_summary_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="cox_regression_articles_summary_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="cox_regression_articles_summary_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">COX REGRESSION HAZARDS MODEL</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary-of-articles" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-articles">SUMMARY OF ARTICLES</h2>
<hr>
<section id="article-1-what-is-coxs-proportional-hazards-model-by-tibshirani-r.-20221" class="level3">
<h3 class="anchored" data-anchor-id="article-1-what-is-coxs-proportional-hazards-model-by-tibshirani-r.-20221">Article #1: ‚ÄúWhat is Cox‚Äôs proportional hazards model?‚Äù by Tibshirani R., 2022<sup>1</sup></h3>
<p>The author discussed the basics of Cox proportional hazards model,&nbsp; including mathematical foundation<sup>1</sup>. The Cox proportional hazards model is used for survival analysis, which estimates the time until a particular event occurs, including death or disease. The model investigates the association between survival time of patients and predictors.</p>
<ul>
<li><p>Outcome variable: the time until an even occurs.</p></li>
<li><p>A patient‚Äôs survival time is censored if the patient survives, or event didn‚Äôt occur until the end of the study.</p></li>
<li><p>For each subject there is time to event (T), i.e.&nbsp;the time at which event occur or censoring time (C), i.e the time the subject drops out of the study or the study ends.</p></li>
<li><p>For each subject, either T or C is observed, whichever occur first. We observe the random variable Y=min(T,C).</p></li>
<li><p>We also observe a status indicator ùõø, with ùõø =1 if we observe the event and ùõø=0 if we observe the censoring time.</p></li>
<li><p>The dataset being analyzed consists of n(Y, ùõø) for each subject in the study, denoted by (Y<sub>1</sub>, ùõø<sub>1</sub>)‚Ä¶ (Y<sub>n</sub>, ùõø<sub>n</sub>).</p></li>
<li><p>The Kaplan-Meier survival estimates the probability of survival from observed survival times.</p></li>
<li><p>The Kaplan-Meier survival curve summarize the survival time based on calculated survival probability, e.g., median survival time.</p>
<ul>
<li><p>Survival probability for each time point, t<sub>1</sub>&lt;t<sub>2</sub>&lt;t<sub>3</sub>‚Ä¶&lt;t<sub>k</sub> is calculated based on the number of patients n<sub>1</sub> who are still alive and the number who died at t<sub>1</sub>, i.e., d<sub>1</sub>. Survival probability = (n<sub>1</sub> - d<sub>1</sub>)/ n<sub>1</sub></p></li>
<li><p>The Kaplan‚ÄìMeier survival curve computes the product of probabilities calculated for each time point</p></li>
<li><p>Median survival time is the time at which the survival probability is 0.5</p></li>
<li><p>The simple Kaplan-Meier survival analysis does not take into account covariates, while Cox regression allow assessing the effect of each predictor.</p></li>
</ul></li>
<li><p>Cox regression</p>
<ul>
<li><p>Cox regression model is based on the hazard function <em>h(t|x</em>), i.e., the probability that an individual with predictors x will die at time t, provided that the individual is alive prior to t.</p></li>
<li><p>The hazard for an individual is calculated by the formula: <em>h(t | x) = h<sub>0</sub>(t)exp(x<sub>i</sub>Œ≤<sub>i</sub>).</em></p>
<ul>
<li><p><em>h<sub>0</sub>(t) :</em> baseline hazard corresponding to x=0</p></li>
<li><p>x : predictor</p></li>
<li><p>Œ≤: the regression parameter</p></li>
</ul></li>
</ul></li>
<li><p>Cox‚Äôs proportional hazards model allows computing parameter estimates (for each covariate), standard errors and confidence intervals.</p></li>
<li><p>Cox regression allows modelling time-dependent covariates, where a patient characteristic is measured during each time point. The method can also handle high-dimensional data by incorporating sparsity penalties such as the lasso</p></li>
</ul>
<hr>
</section>
<section id="article-2-variables-with-time-varying-effects-and-the-cox-model-some-statistical-concepts-illustrated-with-a-prognostic-factor-study-in-breast-cancer-by-bellera-et-al.-2010.2" class="level3">
<h3 class="anchored" data-anchor-id="article-2-variables-with-time-varying-effects-and-the-cox-model-some-statistical-concepts-illustrated-with-a-prognostic-factor-study-in-breast-cancer-by-bellera-et-al.-2010.2">Article #2<strong>:</strong> ‚ÄúVariables with time-varying effects and the Cox model: Some statistical concepts illustrated with a prognostic factor study in breast cancer‚Äù by Bellera et al., 2010.<sup>2</sup></h3>
<p>The article discusses the importance of the proportional hazard assumption in the Cox proportional hazards model. The authors also describe methods to assess if this assumption is violated.</p>
<ul>
<li><p>The fundamental assumption of cox proportional hazard model is the proportionality of the hazards, implying that the factors investigated have a constant impact on the hazard - or risk - over time. The proportional hazard (PH) assumption is violated If variables that change over time are included without proper modeling.</p></li>
<li><p>For single covariate, the hazard is: h<sub>x</sub>(t)=h<sub>0</sub>(t)exp(<em>Œ≤x);</em></p>
<ul>
<li><p>h<sub>0</sub>(t) = baseline hazard rate</p></li>
<li><p><em>Œ≤x =</em> coefficient of the regression function</p></li>
</ul></li>
<li><p>The hazards for two subjects with covariate values x<sub>1</sub> and x<sub>2</sub> are given by by hx<sub>1</sub>(t) = h<sub>0</sub>(t) exp(Œ≤x<sub>1</sub>) and hx<sub>2</sub>(t) = h<sub>0</sub>(t) exp(Œ≤x<sub>2</sub>) respectively</p></li>
<li><p>The hazard ratio is expressed as: HR = hx<sub>2</sub>(t)/ hx<sub>1</sub>(t) = exp[Œ≤(x<sub>2</sub>- x<sub>1</sub>)]</p></li>
<li><p>Based on the assumption of proportional hazards, the hazard ratio HR is constant although the hazard rate hx(t) is allowed to vary over time.</p></li>
<li><p>Different graphical strategies to assess proportionality assumption</p>
<ul>
<li><p>1) Kaplan-Meier Survival Distribution (S(t)): Plot (S(t) ) as a function of survival time for each level covariate. PH assumption is met if the curves should steadily drift apart.</p>
<ul>
<li>Limitation: Kaplan-Meier plots become cluttered if categorical variables have multiple levels</li>
</ul></li>
<li><p>2) plot the function log(-log(S(t))) as a function of the log survival time (log represent natural log). Stratum-specific log-minus-log plots should be approximately parallel if assumption is met.</p>
<ul>
<li>Limitation: Rarely perfectly parallel, less precise at longer times.</li>
</ul></li>
</ul></li>
<li><p>Modeling approach to assess non-proportionality</p>
<ul>
<li>Cox introduced a time-dependent variable by adding an interaction term between predictors and a function of survival time that is included in the model, then test the significance of this interaction term to assess non-proportionality. Covariates that are significant are not proportional.</li>
</ul></li>
</ul>
<hr>
</section>
<section id="article-3-testing-and-interpreting-assumptions-of-cox-regression-analysis-by-patil-and-dessai-2019.3" class="level3">
<h3 class="anchored" data-anchor-id="article-3-testing-and-interpreting-assumptions-of-cox-regression-analysis-by-patil-and-dessai-2019.3">Article #3: ‚ÄúTesting and interpreting assumptions of COX regression analysis‚Äù by Patil &nbsp;and Dessai, 2019.<sup>3</sup></h3>
<p>The article discusses assumptions underlying COX regression analysis, how to test them and their importance in ensuring validity of results.</p>
<ul>
<li><p>The two assumptions discussed in the article are random censoring and proportional hazard assumption.</p></li>
<li><p>The random censoring assumption would be met if patients who are censored are random sample from the study population. There is no statistical test for this assumption, and it can be achieved by rigorous experimental design.</p></li>
<li><p>The proportional hazard assumption states that the hazard function (hazard ratio) for two groups (e.g., experimental arm and standard arm) should remain proportional, i.e., hazard ratio is constant over time.</p>
<ul>
<li><p>Hazard ratio represents the relative likelihood of an event happening in the experimental group with respect to the standard group.</p></li>
<li><p>Hazard ratio at time ‚Äút‚Äù = (Cumulative hazard rate at time ‚Äút‚Äù in the experimental arm) √∑ (Cumulative hazard rate at time ‚Äút‚Äù in the standard arm)</p></li>
<li><p>Cumulative hazard rate at time t is the integrated value</p></li>
<li><p>The proportional hazards assumption can be tested by three methods, Kaplan-Meier curves, log-minus-log plots and Schoenfeld Residuals.</p></li>
<li><p>In Kaplan-Meier curves, assumption is violated if there is a crossing of the Kaplan-Meier curves of the two groups or the curve of one of the groups drops down, while the other plateaus.</p></li>
<li><p>Schoenfeld Residuals plot can be generated in R and example codes are&nbsp; provided in the article. The plot of Schoenfeld residuals against time should show a random scatter around zero if the proportional hazards assumption holds. A systematic pattern or trend indicates a violation of this assumption.</p></li>
</ul></li>
</ul>
<hr>
</section>
<section id="article-4-the-cox-proportional-hazards-model-and-its-characteristics-by-kleinbaum-dg-1996.4" class="level3">
<h3 class="anchored" data-anchor-id="article-4-the-cox-proportional-hazards-model-and-its-characteristics-by-kleinbaum-dg-1996.4">Article #4: ‚ÄúThe Cox Proportional Hazards Model and Its Characteristics‚Äù by Kleinbaum DG, 1996.<sup>4</sup></h3>
<p>In this book chapter, the author introduces the basic concepts of the Cox proportional hazards (PH) model, reasons for its popularity, and assumptions. Because the basic concepts and assumptions are summarized above, the following summary is only for Section III: Why is the Cox PH model popular.</p>
<ul>
<li><p>One of the properties of the Cox PH model is that the baseline hazard (h0) is an unspecified field, which makes it a semiparametric model.</p></li>
<li><p>The Cox model is popular because it is robust and can provide reliable estimates without specifying the baseline hazard function.</p></li>
<li><p>The Cox model is defined as the product of baseline hazards and exponential expressions of variables. The exponential product portion of the model will always provide hazard estimates that are non-negative. This property is appealing because the hazards ratio must range between 0 and infinity.</p></li>
<li><p>Even though the baseline hazard is not known, it is possible to estimate the Bs in the exponential part of the equation. Hence, the effect of variables included in the model can be estimated.</p></li>
<li><p>The Cox model is preferred over logistic regression when the outcome variable is time to event, and censoring is involved. The logistic model uses 0,1 outcome and ignores survival times and censoring.</p></li>
</ul>
<hr>
</section>
<section id="article-5-time-varying-covariates-and-coefficients-in-cox-regression-models-by-zhang-et-al.-2018.5" class="level3">
<h3 class="anchored" data-anchor-id="article-5-time-varying-covariates-and-coefficients-in-cox-regression-models-by-zhang-et-al.-2018.5">Article #5: <strong>‚Äú</strong>Time-varying covariates and coefficients in Cox regression models‚Äù by Zhang et al., 2018.<sup>5</sup></h3>
<p>The article discusses how to analyze time-varying covariates, i.e., variables that change over time during follow-up period, in Cox regression model.</p>
<ul>
<li><p>Time-varying covariates are classified as internal or external. Internal covariates are measured on the subject and can directly affect the failure process. External covariates develop independently of the subject‚Äôs survival or failure process, such as environmental factors.</p></li>
<li><p>Time-varying covariates can be included in Cox regression by including a separate time-varying coefficient g.</p>
<ul>
<li><p>General Cox PH model:</p>
<ul>
<li><p><span class="math inline">\(\lambda\)</span>(t|X) = <span class="math inline">\(\lambda_0(t) \exp(\beta X)\)</span></p></li>
<li><p>where <span class="math inline">\(\lambda_0(t)\)</span> is the baseline hazard function.</p></li>
<li><p>Œ≤ =(Œ≤1,&nbsp;Œ≤2,&nbsp;‚Ä¶,&nbsp;Œ≤p) is a vector of regression coefficients.</p></li>
<li><p>X is a vector of time-fixed covariates.</p></li>
</ul></li>
<li><p>Cox PH model with time-varying covariates</p>
<ul>
<li><p><span class="math inline">\(\lambda\)</span>(t|X) = <span class="math inline">\(\lambda_0(t) \exp(\beta X +\gamma Xg(t))\)</span></p></li>
<li><p>where Œ≤ and <span class="math inline">\(\gamma\)</span> are coefficients of time-fixed and time-varying covariate respectively. Xg(t) is time interaction function.</p></li>
</ul></li>
</ul></li>
</ul>
<hr>
</section>
<section id="article-6-survival-analysispart-2-cox-proportional-hazards-model-by-deo-et-al.-2021.6" class="level3">
<h3 class="anchored" data-anchor-id="article-6-survival-analysispart-2-cox-proportional-hazards-model-by-deo-et-al.-2021.6">Article #6: <strong>‚Äú</strong>Survival analysis‚Äîpart 2: Cox proportional hazards model‚Äù by Deo et al., 2021.<sup>6</sup></h3>
<p>The authors provide an overview of the Cox proportional hazards model, including use of the log-rank test for comparing survival between two groups and its limitations.</p>
<ul>
<li><p>The log-rank test allows assessing the effect of a variable on the outcome, one variable at a time. It does not allow assessing the simultaneous impact of multiple variables at the same time.</p></li>
<li><p>On the other hand, the Cox PH model allows investigating effects of several variables on survival while accounting for confounders.</p></li>
<li><p>The article discusses Cox PH model assumption, and estimation of hazard ratio,&nbsp; however, they are not summarized here because they have been included in summaries of other articles.</p></li>
<li><p>Steps in survival analysis using the Cox PH model includes:</p>
<ul>
<li><p>Create a null hypothesis, e.g., survival time S(<em>t</em>) for group 1 = S(<em>t</em>) for group 2</p></li>
<li><p>Generate survival estimates for group 1 and group 2: i.e., the observed survival for group 1 and group 2 in the study cohort.</p></li>
<li><p>Perform Log-rank test to investigate whether the survivor curves for the two groups are statistically different (<em>p</em>&nbsp;value).</p></li>
<li><p>Construct the Cox PH model</p></li>
<li><p>Test whether assumptions are met. Consider extension of Cox PH model if they not met.</p></li>
</ul></li>
</ul>
<p><strong>REFERENCES</strong></p>
<ol type="1">
<li><p>Tibshirani R. What is Cox‚Äôs proportional hazards model? <em>Signif (Oxf)</em>. 2022;19(2):38-39.</p></li>
<li><p>Bellera CA, MacGrogan G, Debled M, de Lara CT, Brouste V, Mathoulin-P√©lissier S. Variables with time-varying effects and the Cox model: some statistical concepts illustrated with a prognostic factor study in breast cancer. <em>BMC Med Res Methodol</em>. 2010;10(1):20.</p></li>
<li><p>Patil V, Dessai S. Testing and interpreting assumptions of COX regression analysis. <em>Cancer Res Stat Treat</em>. 2019;2(1):108.</p></li>
<li><p>Kleinbaum DG. The cox proportional hazards model and its characteristics. In: <em>Survival Analysis</em>. Springer New York; 1996:83-128.</p></li>
<li><p>Zhang Z, Reinikainen J, Adeleke KA, Pieterse ME, Groothuis-Oudshoorn CGM. Time-varying covariates and coefficients in Cox regression models. <em>Ann Transl Med</em>. 2018;6(7):121.</p></li>
<li><p>Deo SV, Deo V, Sundaram V. Survival analysis-part 2: Cox proportional hazards model. <em>Indian J Thorac Cardiovasc Surg</em>. 2021;37(2):229-233.</p></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>

